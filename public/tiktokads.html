<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TikTok Ads ‚Äì Stegvis</title>
  <link rel="stylesheet" href="css/tiktokads.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
</head>
<body>
  <div class="sidebar">
    <div class="logo">
      <img src="images/logo.png" alt="Logotyp" class="logo-img" />
    </div>
    <ul class="nav-menu">
      <li><a href="customerportal.html"><i class="fas fa-home"></i> Hem</a></li>
      <li><a href="googleads.html"><i class="fab fa-google"></i> Google Ads</a></li>
      <li><a href="metaads.html"><i class="fab fa-facebook"></i> Meta Ads</a></li>
      <li class="active"><a href="tiktokads.html"><i class="fab fa-tiktok"></i> TikTok Ads</a></li>
      <li><a href="linkedin.html"><i class="fab fa-linkedin"></i> Linkedin Ads</a></li>
      <li><a href="aimarknadsstudio.html"><i class="fas fa-magic"></i> AI Studio</a></li>
      <li><a href="radgivning.html"><i class="fas fa-headset"></i> R√•dgivning</a></li>
    </ul>
    <div class="help"><i class="fas fa-question-circle"></i> Hj√§lp</div>
  </div>

  <div class="main-content">
    <a href="marknadsf√∂ring.html" class="back-link">&larr; Tillbaka</a>

    <form id="stepForm">
  <div class="progress-text" id="progressText">Steg 1 av 4</div>
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>

      <div class="form-step active">
    <h2>Vad √§r m√•let med kampanjen?</h2>
    <div class="options">
      <label><input type="radio" name="objective" value="awareness" required /> Varum√§rkesmedvetenhet</label>
      <label><input type="radio" name="objective" value="traffic" /> Webbplatstrafik</label>
      <label><input type="radio" name="objective" value="conversions" /> Konverteringar</label>
      <label><input type="radio" name="objective" value="followers" /> Fler f√∂ljare</label>
    </div>
    <div class="form-buttons">
      <button type="button" onclick="nextStep()">N√§sta</button>
    </div>
  </div>


      <!-- Steg 2 -->
      <div class="form-step">
        <h2>Beskriv din m√•lgrupp</h2>
        <textarea name="target" rows="3" placeholder="√Ölder, intressen, plats" required></textarea>
        <div class="form-buttons">
          <button type="button" onclick="prevStep()">F√∂reg√•ende</button>
          <button type="button" onclick="nextStep()">N√§sta</button>
        </div>
      </div>

      <!-- Steg 3 -->
      <div class="form-step">
        <h2>Vad vill du kommunicera?</h2>
        <textarea name="message" rows="3" placeholder="Skriv ditt budskap" required></textarea>
        <div class="form-buttons">
          <button type="button" onclick="prevStep()">F√∂reg√•ende</button>
          <button type="button" onclick="nextStep()">N√§sta</button>
        </div>
      </div>

      <!-- Steg 4 -->
      <div class="form-step">
        <h2>Vilken stil vill du ha?</h2>
        <select name="style">
          <option value="">V√§lj stil</option>
          <option value="trendig">Trendig & ungdomlig</option>
          <option value="professionell">Professionell & tydlig</option>
          <option value="humor">Humoristisk</option>
          <option value="storytelling">Ber√§ttande/storytelling</option>
        </select>
        <label for="hashtag">F√∂reslagna hashtags (valfritt):</label>
        <input type="text" name="hashtag" placeholder="#dinhashtag"/>

        <label for="cta">Call-to-action:</label>
        <select name="cta">
          <option value="">V√§lj CTA</option>
          <option value="shop">K√∂p nu</option>
          <option value="read">L√§s mer</option>
          <option value="signup">Registrera dig</option>
          <option value="visit">Bes√∂k webbplats</option>
        </select>

        <div class="form-buttons">
          <button type="button" onclick="prevStep()">F√∂reg√•ende</button>
          <button type="submit">Skicka</button>
        </div>
      </div>

     <!-- Tack -->
      <div class="form-step" id="thankYouStep">
        <h2>Tack f√∂r din f√∂rfr√•gan! üéâ</h2>
        <p style="margin-top: 16px; font-size: 16px; line-height: 1.6; text-align: center;">
          Din kampanjinfo har skickats till v√•ra experter.<br />
          Vi √•terkommer med ett TikTok-f√∂rslag inom kort.<br />
          Du hittar f√∂rfr√•gan under <strong>Analyser</strong>.
        </p>
      </div>
    </form>
  </div>

  <script>
document.addEventListener("DOMContentLoaded", () => {
  let currentStep = 0;
  const steps = document.querySelectorAll(".form-step");

  function showStep(index, direction) {
    steps[currentStep].classList.remove("active", "slide-up", "slide-down");
    if (direction === "next") {
      steps[index].classList.add("slide-up");
    } else {
      steps[index].classList.add("slide-down");
    }
    steps[index].classList.add("active");
    currentStep = index;
    updateProgressBar();
  }

  function nextStep() {
    const current = steps[currentStep];
    const inputs = current.querySelectorAll("input, textarea, select");

    for (const input of inputs) {
      if (input.hasAttribute("required") && !input.value.trim() && !input.checked) {
        alert("V√§nligen fyll i f√§ltet innan du g√•r vidare.");
        return;
      }
    }

    if (currentStep < steps.length - 2) {
      showStep(currentStep + 1, "next");
    }
  }

  function prevStep() {
    if (currentStep > 0) {
      showStep(currentStep - 1, "prev");
    }
  }

  function updateProgressBar() {
    const total = steps.length - 1;
    const percent = (currentStep / total) * 100;
    document.getElementById("progressBar").style.width = percent + "%";
    document.getElementById("progressText").innerText = `Steg ${currentStep + 1} av ${total}`;
  }

  // üü¢ Skicka till servern
  document.getElementById("stepForm").addEventListener("submit", function (e) {
    e.preventDefault();

    const data = Object.fromEntries(new FormData(this).entries());

    fetch("/api/ads/tiktok", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    })
    .then(res => res.ok ? res.json() : Promise.reject("Serverfel"))
    .then(() => {
      showStep(currentStep + 1, "next"); // visa tack-sidan
    })
    .catch(err => {
      alert("‚ùå Kunde inte skicka formul√§ret. F√∂rs√∂k igen.");
      console.error(err);
    });
  });

  // CSP-h√§rdning: ta bort inline onclick och bind s√§kert
document.querySelectorAll('button[onclick="nextStep()"]').forEach(btn => {
  btn.removeAttribute('onclick');
  btn.addEventListener('click', nextStep);
});
document.querySelectorAll('button[onclick="prevStep()"]').forEach(btn => {
  btn.removeAttribute('onclick');
  btn.addEventListener('click', prevStep);
});

  updateProgressBar();
});
</script>
</body>
</html>
